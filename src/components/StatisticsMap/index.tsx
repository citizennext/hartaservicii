import React from 'react';
import { districtSocialServices } from './SocialServices';
import { districtSvgMapping } from './DistrictMapping';

type Props = {
  sqSizeWidth: number;
  sqSizeHeight: number;
  classStatisticsMap: string;
  title: string;
  mapColor: string;
  districtHueAndSaturation: string;
  districtLightness: number;
};

function StatisticsMap(props: Props) {
  // Width of the enclosing square
  const sqSizeWidth = props.sqSizeWidth;
  // Height of the enclosing square
  const sqSizeHeight = props.sqSizeHeight;
  // Enclose circle in a circumscribing square
  const viewBox = `0 0 ${sqSizeWidth} ${sqSizeHeight}`;
  // Map background color in hex
  const mapColor = props.mapColor;
  // Current color lightness
  const currentLightness = props.districtLightness;

  const districtAmounts = Object.values(districtSocialServices).map(amount => {
    return amount;
  });
  const maxAmount = Math.max(...districtAmounts);

  function lightness(amount: number) {
    return 100 - (amount / maxAmount) * currentLightness;
  }

  return (
    <div className={props.classStatisticsMap}>
      <svg width={sqSizeWidth} height={sqSizeHeight} viewBox={viewBox}>
        <path
          d="M 364.88 217.32 L 364.64 216.93 C 363.111 214.226 360.684 212.143 357.78 211.04 C 356.378 210.571 354.909 210.334 353.43 210.34 C 352.036 210.348 350.647 210.516 349.29 210.84 C 343.13 212.26 337.07 216.45 333.85 218.96 C 333.442 218.835 333.047 218.671 332.67 218.47 L 331.98 218.14 C 331.581 217.975 331.153 217.89 330.72 217.89 C 330.496 217.894 330.273 217.911 330.05 217.94 L 328.81 218.08 V 219.33 C 328.854 220.27 328.61 221.202 328.11 222 C 327.788 222.397 327.376 222.712 326.909 222.919 C 326.441 223.126 325.931 223.219 325.42 223.19 H 325 C 323.89 222.75 322.75 222.35 321.62 221.95 C 319.493 221.269 317.42 220.427 315.42 219.43 C 312.756 218.115 310.664 215.871 309.54 213.12 L 309.28 212.5 L 309.42 212.35 L 309.04 211.9 L 308.8 211.31 L 308.65 211.44 L 308.58 211.37 C 307.93 210.6 307.31 209.81 306.7 209.03 C 305.378 207.209 303.866 205.533 302.19 204.03 C 302.562 203.747 302.953 203.49 303.36 203.26 C 303.62 203.11 303.87 202.96 304.09 202.81 C 304.513 202.578 304.886 202.266 305.188 201.89 C 305.49 201.514 305.715 201.083 305.85 200.62 H 307.11 L 305.66 198.41 C 303.28 194.78 302.98 190.81 302.89 187.36 C 302.89 186.75 302.89 186.13 302.89 185.52 C 302.976 182.186 302.592 178.857 301.75 175.63 L 301.94 175.32 C 302.376 174.609 302.634 173.802 302.69 172.97 C 302.715 172.509 302.638 172.048 302.466 171.619 C 302.293 171.191 302.028 170.805 301.69 170.49 C 303.558 167.855 305.046 164.97 306.11 161.92 C 307.32 158.05 307.11 154.72 305.38 151.72 C 307.15 146.06 304.38 139.34 300.75 135.07 C 301.249 133.496 301.314 131.818 300.94 130.21 C 300.546 128.976 299.737 127.916 298.65 127.21 C 297.956 126.729 297.232 126.295 296.48 125.91 C 294.798 125.086 293.269 123.98 291.96 122.64 C 289.6 120.04 288.27 117.22 286.87 113.51 L 286.67 112.98 L 286.16 112.73 C 284.353 111.842 282.895 110.374 282.02 108.56 C 281.317 107.054 280.742 105.492 280.3 103.89 L 279.74 102.11 L 279.08 101.87 C 277.52 101.3 276.51 99.96 275.47 98.44 C 274.31 96.75 273.21 95.18 271.69 94.38 L 271.31 93.47 C 270.49 91.47 269.7 89.47 268.91 87.41 C 264.82 76.84 260.6 65.91 250.85 59.9 L 250.32 59.58 L 249.73 59.74 C 248.489 60.0308 247.23 60.2379 245.96 60.36 C 245.38 60.43 244.8 60.5 244.24 60.59 C 242.187 60.7854 240.233 61.5664 238.61 62.84 C 238.039 62.6871 237.451 62.6064 236.86 62.6 C 235.804 62.6043 234.778 62.9556 233.94 63.6 C 232.7 64.6589 231.7 65.9718 231.01 67.45 C 230.76 67.92 230.52 68.4 230.27 68.9 C 229.09 71.26 227.86 73.71 225.67 74.9 L 225.37 75.06 H 225.23 C 224.8 75.06 224.37 75 223.93 75 H 223.72 C 220.52 75.2316 217.367 75.9046 214.35 77 C 213.41 77.3 212.45 77.6 211.47 77.88 C 210.196 77.3835 208.838 77.1357 207.47 77.15 C 206.053 77.1762 204.643 77.3471 203.26 77.66 L 201.63 78.02 C 199.668 78.5405 197.658 78.8556 195.63 78.96 H 195 L 194.61 79.27 C 193.068 80.6385 191.722 82.2133 190.61 83.95 C 190.33 84.37 190.04 84.78 189.74 85.2 C 188.567 87.1042 186.815 88.583 184.74 89.42 L 184.04 89.66 H 183.32 H 182.48 C 182.143 89.6567 181.807 89.6131 181.48 89.53 C 179.55 86.53 176.88 84.26 174.05 81.86 C 172.159 80.2986 170.359 78.6291 168.66 76.86 L 168.36 76.54 L 167.93 76.44 C 167.425 76.3293 166.908 76.2757 166.39 76.28 C 164.265 76.4248 162.176 76.9041 160.2 77.7 L 158.58 78.23 C 157.465 78.6336 156.295 78.8695 155.11 78.93 C 154.877 78.9446 154.643 78.9446 154.41 78.93 C 153.772 78.8159 153.165 78.568 152.629 78.2027 C 152.093 77.8373 151.64 77.3627 151.3 76.81 L 151.2 76.66 L 151.05 76.54 C 150.298 75.8761 149.324 75.5191 148.32 75.54 C 147.473 75.574 146.634 75.7117 145.82 75.95 L 145.59 76.01 C 144.899 76.2207 144.189 76.368 143.47 76.45 H 143.09 C 142.551 76.4608 142.019 76.326 141.55 76.06 C 141.011 75.491 140.361 75.038 139.641 74.7285 C 138.92 74.419 138.144 74.2596 137.36 74.26 L 136.04 74.16 C 135.56 74.16 135.04 74.1 134.57 74.05 L 133.51 73.94 L 132.94 73.79 L 132.75 73.69 H 132.46 C 128.77 73.51 125.39 71.77 122.46 68.51 L 122.06 68.07 H 121.46 C 120.961 68.0649 120.47 67.9379 120.03 67.7 L 119.25 67.23 L 118.49 67.75 C 117.2 68.64 115.82 69.48 114.49 70.3 C 109.92 73.1 105.2 75.99 103.03 81.05 C 100.63 81.29 99.0304 82.77 97.2804 84.32 L 96.8204 84.74 C 96.6479 84.7885 96.4695 84.812 96.2904 84.81 C 95.7482 84.7837 95.2186 84.6368 94.7404 84.38 L 94.0004 83.8 C 93.5504 83.57 93.1404 83.37 92.7504 83.2 L 91.7504 82.8 L 91.0704 83.6 C 90.4553 84.2994 89.6893 84.8499 88.8304 85.21 C 88.1004 85.54 87.3204 85.82 86.5604 86.09 C 86.0004 86.29 85.4504 86.48 84.9204 86.69 C 83.5806 87.1453 82.3628 87.9013 81.3604 88.9 C 80.9013 89.4224 80.5508 90.031 80.3293 90.6903 C 80.1078 91.3496 80.0198 92.0464 80.0704 92.74 C 78.8821 93.0685 77.7869 93.6699 76.872 94.4962 C 75.9571 95.3226 75.2477 96.3512 74.8004 97.5 C 73.8434 99.763 73.3438 102.193 73.3304 104.65 C 71.2042 105.839 69.3805 107.502 68.0004 109.51 C 67.2876 110.426 66.5265 111.304 65.7204 112.14 L 65.2104 112.66 L 65.3304 113.38 C 65.4854 115.264 65.0182 117.147 64.0004 118.74 C 62.9881 120.514 61.6275 122.065 60.0004 123.3 L 59.4804 123.7 V 124.36 C 59.3104 127.36 57.6104 129.65 55.9704 131.9 L 55.3104 132.81 C 53.3704 135.55 51.7204 138.35 52.6404 142.4 C 51.2645 142.593 49.9509 143.097 48.8 143.875 C 47.6492 144.654 46.6915 145.685 46.0004 146.89 C 45.1791 148.122 44.6241 149.511 44.371 150.97 C 44.1178 152.428 44.1721 153.924 44.5304 155.36 C 44.5168 155.822 44.3555 156.267 44.0704 156.63 C 43.7408 157.008 43.3261 157.303 42.8604 157.49 C 42.1592 157.785 41.4329 158.016 40.6904 158.18 L 39.9404 158.37 L 38.9404 158.65 V 159.71 C 38.9182 160.574 38.692 161.42 38.2804 162.18 C 37.9037 162.809 37.4931 163.416 37.0504 164 L 36.4704 164.88 L 36.0404 165.04 C 35.5504 165.23 34.9404 165.47 34.1204 165.71 C 32.5802 164.806 30.9159 164.132 29.1804 163.71 C 28.5795 163.576 27.9661 163.505 27.3504 163.5 C 26.1237 163.471 24.923 163.855 23.9404 164.59 L 23.5704 164.88 L 23.4304 165.34 C 23.1696 166.162 23.0314 167.018 23.0204 167.88 V 168.21 C 21.8789 168.634 20.7806 169.167 19.7404 169.8 C 17.7005 168.684 15.3929 168.152 13.0704 168.26 C 11.7104 168.26 10.3204 168.37 9.01038 168.5 L 8.45038 168.55 L 8.10038 169 C 7.76038 169.38 7.38038 169.79 6.85038 170.35 L 6.52038 170.71 V 171.2 C 6.31845 172.678 6.48689 174.182 7.01054 175.579 C 7.53419 176.975 8.39665 178.22 9.52038 179.2 C 10.4304 180.11 11.5204 181.01 12.7304 181.97 C 14.3572 183.244 15.9161 184.603 17.4004 186.04 C 18.0055 186.749 18.4948 187.549 18.8504 188.41 L 19.0704 188.84 C 19.2904 189.3 19.4904 189.71 19.6604 190.03 C 19.7611 190.216 19.8712 190.396 19.9904 190.57 L 20.1904 190.85 L 20.4604 191.01 C 23.4604 192.87 24.8404 195.63 24.5704 199.43 C 24.4429 200.918 24.2258 202.398 23.9204 203.86 C 23.5871 205.351 23.4062 206.872 23.3804 208.4 V 208.89 L 23.6904 209.26 C 26.4556 212.65 29.7475 215.574 33.4404 217.92 L 33.7604 218.12 H 34.1304 C 36.8404 218.23 38.9204 219.61 40.8304 221.02 L 41.2504 221.34 C 43.2504 222.82 45.3104 224.34 48.0104 224.94 C 48.3151 226.051 48.8238 227.095 49.5104 228.02 C 49.6028 228.443 49.6398 228.877 49.6204 229.31 V 229.39 C 49.0495 230.114 48.3757 230.751 47.6204 231.28 L 47.2404 231.58 C 46.3998 232.205 45.6954 232.994 45.1704 233.9 L 44.7104 234.71 L 45.2804 235.46 C 45.9607 236.246 46.7329 236.948 47.5804 237.55 C 48.0331 237.833 48.4211 238.208 48.7192 238.651 C 49.0173 239.094 49.2187 239.594 49.3104 240.12 C 49.1947 240.416 49.0577 240.704 48.9004 240.98 C 48.523 241.17 48.1027 241.26 47.6804 241.24 C 47.3904 241.24 47.1204 241.24 46.8604 241.24 H 46.4204 H 45.8804 C 45.5437 241.234 45.2078 241.271 44.8804 241.35 C 44.4016 241.471 43.9698 241.732 43.6404 242.1 L 43.3804 242.38 L 43.2804 242.74 C 43.2804 242.93 43.1804 243.16 43.1504 243.41 L 43.0904 243.86 L 43.3104 244.26 C 43.9071 245.163 44.6199 245.983 45.4304 246.7 L 45.9004 247.14 L 46.5404 247.09 C 46.8504 247.09 47.1604 247.04 47.4704 247.04 C 48.7406 246.981 49.998 247.317 51.0704 248 C 51.6693 248.492 52.1455 249.117 52.4614 249.825 C 52.7773 250.534 52.9241 251.305 52.8904 252.08 V 253.08 L 53.8204 253.41 C 55.7708 254.004 57.785 254.363 59.8204 254.48 C 60.5504 254.55 61.2904 254.63 62.0404 254.73 C 64.5204 255.04 67.2904 255.68 68.9704 257.91 V 258.04 L 68.7804 258.55 V 258.76 C 68.7952 259.794 69.1822 260.788 69.8704 261.56 C 70.3388 262.156 70.7193 262.816 71.0004 263.52 L 71.1604 263.97 L 71.5604 264.23 C 72.0525 264.532 72.6232 264.682 73.2004 264.66 C 73.3569 264.67 73.5139 264.67 73.6704 264.66 L 74.6204 264.57 L 74.9004 263.66 C 76.3304 259.03 80.2704 256.14 84.0904 253.35 C 84.7204 252.89 85.3504 252.43 85.9504 251.97 C 86.1371 251.891 86.3377 251.85 86.5404 251.85 C 86.6948 252.004 86.8261 252.179 86.9304 252.37 V 252.42 C 87.7804 254.51 89.9304 255.87 91.9304 257.19 L 92.5604 257.6 C 93.5328 258.153 94.4022 258.871 95.1304 259.72 C 95.4092 260.087 95.612 260.506 95.727 260.953 C 95.8421 261.399 95.867 261.864 95.8004 262.32 C 95.4925 262.597 95.1028 262.765 94.6904 262.8 H 94.1904 C 93.8704 262.8 93.5604 262.8 93.1904 262.74 C 92.5236 262.181 91.7875 261.711 91.0004 261.34 C 90.6452 261.191 90.2654 261.11 89.8804 261.1 H 89.6204 H 89.4904 C 89.0571 261.197 88.6654 261.428 88.3704 261.76 L 87.9204 262.2 V 262.82 C 87.9204 263.37 87.8304 263.53 87.8204 263.54 C 87.5985 263.793 87.3164 263.985 87.0004 264.1 L 86.5404 264.28 C 86.2429 264.396 85.9524 264.53 85.6704 264.68 C 85.407 264.831 85.1813 265.039 85.0104 265.29 L 84.3604 266.04 L 84.8304 266.91 C 89.6604 275.91 96.4404 282.91 104.44 287.11 L 104.82 287.31 C 104.959 287.663 105.001 288.047 104.942 288.421 C 104.882 288.796 104.722 289.148 104.48 289.44 C 103.843 290.188 103.122 290.859 102.33 291.44 L 101.84 291.84 C 100.72 292.669 99.7494 293.684 98.9704 294.84 C 98.5723 295.503 98.3239 296.244 98.2427 297.013 C 98.1615 297.782 98.2495 298.559 98.5004 299.29 V 299.4 L 98.5504 299.5 C 99.075 300.449 99.819 301.258 100.72 301.86 L 101.21 302.4 L 101.51 302.53 C 101.942 302.709 102.404 302.8 102.87 302.8 C 103.255 302.792 103.638 302.739 104.01 302.64 C 104.32 302.56 104.65 302.45 105.01 302.33 C 105.37 302.21 105.64 302.12 106.01 302.04 C 107.168 302.965 108.599 303.482 110.08 303.51 C 111.31 303.455 112.517 303.156 113.63 302.63 L 114.44 302.28 C 115.896 301.515 117.499 301.069 119.14 300.97 C 119.69 300.973 120.237 301.04 120.77 301.17 C 120.861 301.188 120.948 301.218 121.03 301.26 L 121.35 301.38 C 121.69 301.51 122.13 301.64 122.62 301.78 C 123.544 302.046 124.499 302.188 125.46 302.2 H 126.06 C 129.5 304.51 133.5 305.45 137.3 306.2 L 138.7 306.48 C 141.907 306.984 145.042 307.867 148.04 309.11 L 148.38 309.26 L 148.71 309.58 C 148.998 309.864 149.302 310.131 149.62 310.38 L 150.09 310.78 L 150.46 310.85 C 151.035 310.95 151.617 311 152.2 311 C 154.458 310.884 156.666 310.295 158.68 309.27 L 159.46 308.92 C 161.61 307.779 163.973 307.098 166.4 306.92 C 166.816 307.153 167.214 307.417 167.59 307.71 C 167.8 307.87 168.01 308.02 168.21 308.15 C 168.731 308.524 169.324 308.786 169.95 308.92 L 170.89 309.1 L 171.04 309.17 C 172.273 309.732 173.616 310.009 174.97 309.98 C 176.401 309.938 177.825 309.781 179.23 309.51 H 179.5 C 180.536 309.313 181.586 309.2 182.64 309.17 C 182.917 309.155 183.194 309.155 183.47 309.17 C 184.557 309.295 185.578 309.756 186.39 310.49 L 186.93 310.96 L 187.63 310.8 C 188.212 310.673 188.805 310.609 189.4 310.61 C 191.123 310.655 192.805 311.137 194.29 312.01 L 195.7 312.79 C 197.347 313.81 199.132 314.587 201 315.1 L 201.51 315.21 L 201.97 314.97 C 203.116 314.405 204.303 313.927 205.52 313.54 L 206.76 313.1 C 208.5 312.543 210.064 311.544 211.3 310.2 H 211.37 C 211.87 310.352 212.388 310.433 212.91 310.44 C 213.345 310.44 213.777 310.373 214.19 310.24 C 215.147 309.873 215.992 309.263 216.64 308.47 C 217.388 307.595 218.08 306.673 218.71 305.71 C 219.4 304.71 220.19 303.55 221.11 302.43 L 222.17 301.14 C 224.72 297.99 226.17 296.25 230.53 294.42 C 231.019 294.192 231.491 293.928 231.94 293.63 C 232.52 293.28 233.21 292.86 233.94 292.44 C 235.059 291.763 236.282 291.276 237.56 291 H 237.63 V 291.07 H 238.57 C 239.62 291.227 240.679 291.304 241.74 291.3 C 245.915 291.155 250.028 290.239 253.87 288.6 L 256.87 287.43 C 260.582 285.769 264.48 284.561 268.48 283.83 C 269.21 284.15 269.89 284.5 270.57 284.83 L 272.05 285.57 L 272.17 285.62 L 273.04 286.79 C 274.322 288.416 275.952 289.732 277.811 290.643 C 279.671 291.553 281.71 292.034 283.78 292.05 C 285.147 292.055 286.503 291.808 287.78 291.32 C 288.26 292.339 289.027 293.195 289.986 293.785 C 290.945 294.374 292.055 294.672 293.18 294.64 H 293.4 C 295.517 294.618 297.552 293.821 299.12 292.4 C 299.587 293.267 299.965 294.178 300.25 295.12 C 300.48 295.79 300.71 296.48 300.99 297.12 C 301.83 299.12 303.15 301.55 305.99 302.62 L 306.19 302.7 H 306.8 C 307.083 302.718 307.367 302.718 307.65 302.7 H 307.87 C 308.037 302.689 308.204 302.689 308.37 302.7 C 308.512 302.693 308.652 302.72 308.78 302.78 C 312.08 304.25 317.02 306.01 321.78 306.01 C 323.438 306.035 325.089 305.778 326.66 305.25 L 327.3 305.03 L 327.53 304.41 C 328.643 301.221 329.479 297.942 330.03 294.61 C 330.374 292.723 330.591 290.816 330.68 288.9 C 330.77 287.423 330.59 285.943 330.15 284.53 C 329.57 282.769 328.402 281.261 326.84 280.26 C 326.628 278.938 326.561 277.597 326.64 276.26 C 326.64 275.53 326.64 274.81 326.64 274.13 C 329.64 271.83 330.64 268.65 331.48 266.13 L 331.61 265.73 C 332.41 263.24 333.24 260.67 335.23 258.63 L 335.43 258.82 L 336.38 257.62 C 337.236 256.375 337.84 254.976 338.16 253.5 C 338.415 252.041 339.113 250.697 340.16 249.65 C 343.113 248.322 346.21 247.346 349.39 246.74 C 350.39 246.52 351.33 246.29 352.28 246.05 C 356.23 245.05 360.28 243.67 363.42 240.42 L 363.83 239.99 V 239.4 C 363.68 232.85 364.62 228.74 365.08 222.01 L 364.88 217.32 Z"
          fill={mapColor}
        />

        {Object.entries(districtSocialServices).map((socialService, index) => (
          <path
            className={`${socialService[0]}`}
            key={`map-${socialService[0]}-${index}`}
            d={districtSvgMapping[socialService[0]]}
            fill={`hsl(${props.districtHueAndSaturation}, ${lightness(socialService[1])}%)`}
          />
        ))}

        <path d="M315.68 344.92H53.5898V373.25H315.68V344.92Z" fill="url(#paint0_linear)" />
        <path d="M315.68 373.25H53.5996" stroke="#968584" strokeWidth="3" strokeMiterlimit="10" />
        <path d="M315.68 344.92H53.5996" stroke="#968584" strokeWidth="3" strokeMiterlimit="10" />
        <defs>
          <linearGradient id="paint0_linear" x1="53.5898" y1="359.08" x2="315.68" y2="359.08" gradientUnits="userSpaceOnUse">
            <stop stopColor="white" />
            <stop offset="1" stopColor="#6FBAB6" />
          </linearGradient>
        </defs>
      </svg>

      <p className="map-min-amount">0</p>
      <p className="map-max-amount">600</p>
      <p className="circle-total">{props.title}</p>
    </div>
  );
}

StatisticsMap.defaultProps = {
  sqSizeWidth: 370,
  sqSizeHeight: 380,
  mapColor: `#CDE5C0`,
  districtHueAndSaturation: `177, 35%`,
  districtLightness: 58,
  classStatisticsMap: '',
};

export default StatisticsMap;
